package rv

import (
	"testing"
)

// https://riscv.github.io/riscv-isa-manual/snapshot/unprivileged/#rvc-form

func TestImmCB(t *testing.T) {
	testImm(t, "immCB", immCB, 8+1, immTestData{
		0b_0_00_000_00_01_0_00: 0b_00000001_0,
		0b_0_00_000_00_10_0_00: 0b_00000010_0,
		0b_0_01_000_00_00_0_00: 0b_00000100_0,
		0b_0_10_000_00_00_0_00: 0b_00001000_0,
		0b_0_00_000_00_00_1_00: 0b_00010000_0,
		0b_0_00_000_01_00_0_00: 0b_00100000_0,
		0b_0_00_000_10_00_0_00: 0b_01000000_0,
		0b_1_00_000_00_00_0_00: 0b_10000000_0,
		0b_1_11_000_11_11_1_00: 0b_11111111_0,
		0b_1_11_111_11_11_1_11: 0b_11111111_0,
	})
}

func TestImmCI(t *testing.T) {
	testImm(t, "immCI", immCI, 6, immTestData{
		0b_0_00000_00001_00: 0b_000001,
		0b_0_00000_00010_00: 0b_000010,
		0b_0_00000_00100_00: 0b_000100,
		0b_0_00000_01000_00: 0b_001000,
		0b_0_00000_10000_00: 0b_010000,
		0b_1_00000_00000_00: 0b_100000,
		0b_1_00000_11111_00: 0b_111111,
		0b_1_11111_11111_11: 0b_111111,
	})
}

func TestUimmCI2(t *testing.T) {
	testImmUnsigned(t, "immCI2", immCI2, 6+2, immTestData{
		0b_0_00000_001_00_00: 0b_000001_00,
		0b_0_00000_010_00_00: 0b_000010_00,
		0b_0_00000_100_00_00: 0b_000100_00,
		0b_1_00000_000_00_00: 0b_001000_00,
		0b_0_00000_000_01_00: 0b_010000_00,
		0b_0_00000_000_10_00: 0b_100000_00,
		0b_1_00000_111_11_00: 0b_111111_00,
		0b_1_11111_111_11_11: 0b_111111_00,
	})
}

func TestImmCI4(t *testing.T) {
	testImm(t, "immCI4", immCI4, 6+4, immTestData{
		0b_0_00000_1_0_00_0_00: 0b_000001_0000,
		0b_0_00000_0_0_00_1_00: 0b_000010_0000,
		0b_0_00000_0_1_00_0_00: 0b_000100_0000,
		0b_0_00000_0_0_01_0_00: 0b_001000_0000,
		0b_0_00000_0_0_10_0_00: 0b_010000_0000,
		0b_1_00000_0_0_00_0_00: 0b_100000_0000,
		0b_1_00000_1_1_11_1_00: 0b_111111_0000,
		0b_1_11111_1_1_11_1_11: 0b_111111_0000,
	})
}

func TestImmCIW(t *testing.T) {
	testImmUnsigned(t, "immCIW", immCIW, 8+2, immTestData{
		0b_00_0000_1_0_00000: 0b_00000001_00,
		0b_00_0000_0_1_00000: 0b_00000010_00,
		0b_01_0000_0_0_00000: 0b_00000100_00,
		0b_10_0000_0_0_00000: 0b_00001000_00,
		0b_00_0001_0_0_00000: 0b_00010000_00,
		0b_00_0010_0_0_00000: 0b_00100000_00,
		0b_00_0100_0_0_00000: 0b_01000000_00,
		0b_00_1000_0_0_00000: 0b_10000000_00,
		0b_11_1111_1_1_00000: 0b_11111111_00,
		0b_11_1111_1_1_11111: 0b_11111111_00,
	})
}

func TestImmCJ(t *testing.T) {
	testImm(t, "ImmCJ", immCJ, 11+1, immTestData{
		0b_0_0_00_0_0_0_001_0_00: 0b_00000000001_0,
		0b_0_0_00_0_0_0_010_0_00: 0b_00000000010_0,
		0b_0_0_00_0_0_0_100_0_00: 0b_00000000100_0,
		0b_0_1_00_0_0_0_000_0_00: 0b_00000001000_0,
		0b_0_0_00_0_0_0_000_1_00: 0b_00000010000_0,
		0b_0_0_00_0_1_0_000_0_00: 0b_00000100000_0,
		0b_0_0_00_0_0_1_000_0_00: 0b_00001000000_0,
		0b_0_0_01_0_0_0_000_0_00: 0b_00010000000_0,
		0b_0_0_10_0_0_0_000_0_00: 0b_00100000000_0,
		0b_0_0_00_1_0_0_000_0_00: 0b_01000000000_0,
		0b_1_0_00_0_0_0_000_0_00: 0b_10000000000_0,
		0b_1_1_11_1_1_1_111_1_00: 0b_11111111111_0,
		0b_1_1_11_1_1_1_111_1_11: 0b_11111111111_0,
	})
}

func TestUimmCL(t *testing.T) {
	testImmUnsigned(t, "immCL", immCL, 5+2, immTestData{
		0b_000_000_1_0_00000: 0b_00001_00,
		0b_001_000_0_0_00000: 0b_00010_00,
		0b_010_000_0_0_00000: 0b_00100_00,
		0b_100_000_0_0_00000: 0b_01000_00,
		0b_000_000_0_1_00000: 0b_10000_00,
		0b_111_000_1_1_00000: 0b_11111_00,
		0b_111_111_1_1_11111: 0b_11111_00,
	})
}

func TestUimmCSS(t *testing.T) {
	testImmUnsigned(t, "immCSS", immCSS, 6+2, immTestData{
		0b_0001_00_0000000: 0b_000001_00,
		0b_0010_00_0000000: 0b_000010_00,
		0b_0100_00_0000000: 0b_000100_00,
		0b_1000_00_0000000: 0b_001000_00,
		0b_0000_01_0000000: 0b_010000_00,
		0b_0000_10_0000000: 0b_100000_00,
		0b_1111_11_0000000: 0b_111111_00,
		0b_1111_11_1111111: 0b_111111_00,
	})
}
